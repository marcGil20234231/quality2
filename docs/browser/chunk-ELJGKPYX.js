import{f as d}from"./chunk-KNHRAYHO.js";import{A as o,K as u,N as c,S as m,g as l,j as i,k as n}from"./chunk-4NTA57OQ.js";var U=class s{constructor(e){this.router=e;let r=localStorage.getItem("currentUser");r&&this.currentUserSubject.next(JSON.parse(r))}currentUserSubject=new l(null);currentUser$=this.currentUserSubject.asObservable();login(e,r){if(!e||!r)return n(()=>new Error("Email and password are required"));let t=e.toLowerCase()==="admin@example.com";if(r.length<6)return n(()=>new Error("Invalid credentials"));let f={id:1,username:t?"admin":"user",fullName:t?"Admin User":"Regular User",email:e,role:t?"admin":"user",isAdmin:t,createdAt:new Date().toISOString(),name:t?"Admin User":"Regular User",completedCourses:[]};return i(f).pipe(o(800),u(a=>{localStorage.setItem("currentUser",JSON.stringify(a)),this.currentUserSubject.next(a),this.router.navigate(["/dashboard",t?"admin-dashboard":"user-dashboard"])}))}register(e){if(!e.email||!e.fullName)return n(()=>new Error("Email and full name are required"));let r={id:Math.floor(Math.random()*1e3),username:e.email.split("@")[0]||"user",fullName:e.fullName,email:e.email,role:"user",isAdmin:!1,createdAt:new Date().toISOString(),name:e.fullName,completedCourses:[]};return i(r).pipe(o(800))}logout(){localStorage.removeItem("currentUser"),this.currentUserSubject.next(null),this.router.navigate(["/"])}getCurrentUser(){return this.currentUserSubject.value}isAdmin(){let e=this.currentUserSubject.value;return!!e&&e.isAdmin}isLoggedIn(){return this.currentUserSubject.value!==null}static \u0275fac=function(r){return new(r||s)(m(d))};static \u0275prov=c({token:s,factory:s.\u0275fac,providedIn:"root"})};export{U as a};
